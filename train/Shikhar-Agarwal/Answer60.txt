So in this way  Ganesh also learnt his lesson.It was dharma all along - Parvati's as a mother of the world and of Ganesh; Ganesh's to keep his mother's promise and Shiva's to destroy negative characteristics like ego (tamo-guna) even if the person was his own son. So dharma is situation dependent  is chosen by own self and is different for different people.So Shiva knew about Ganesh  but in the end  even Gods have to follow their dharma.