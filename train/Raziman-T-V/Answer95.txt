Summing this quantity over all values of [math]i[/math] gives the total number of solutions. That is  [math]f(N K) = f(N-1 1) + f(N-2 2) \ldots f(N-K K)[/math].Now  note that evaluating this recurrence naively would take [math]O(NK)[/math] operations  which is too much for the given constraints. So we will reduce the complexity by using matrix exponentiation.Define the vector [math]v(N) = [f(N 1) \ldots f(N K) \ldots f(N+K-1 1) \ldots f(N+K-1 K)]^T[/math]. [math]v(N+1)[/math] can be found from [math]v(N)[/math] by multiplying it by a recurrence matrix [math]M[/math].