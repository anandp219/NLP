Clearly  [math]p^{e_1}[/math] is the gcd of only the set [math]\{p^{e_1}\}[/math]. [math]p^{e_2}[/math] is the gcd of only the sets [math]\{p^{e_2}\} \{p^{e_1} p^{e_2}\}[/math]. In general  [math]p^{e_i}[/math] is the gcd of [math]2^{i-1}[/math] subsets.Thus the product of gcds of all subsets is[math]\prod\limits_{i=1}^n (p^{e_i})^{2^{(i-1)}} = \prod\limits_{i=1}^n p^{e_i 2^{(i-1)}}[/math]The products have to be done modulo the prime [math]P=10^9+7[/math]. Also note that [math]a^b \equiv a^{b \bmod{(P-1)}} \bmod{P}[/math].In the more general case  the trick is to deal with primes individually.First  sieve up to the limit ([math]10^5[/math]) and find all primes in the range - there are less than 10000 of them - and the smallest prime factor for each number.