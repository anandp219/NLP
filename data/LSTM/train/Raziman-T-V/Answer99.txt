As an example  consider the following graph where we want to find the LCA of the vertices [math]u=8[/math] and [math]v=9[/math].The first thing to note is that the depth of the LCA is going to be less than or equal to the depth of both vertices. Thus if the depths of the two vertices are not equal  we can make them equal by going up the ancestry tree of the further vertex as much as necessary. We can use the parent[][] array to do this in [math]O(\log N)[/math] time  essentially by looking at the binary representation of the height we have to jump:1234567int getparent(int u  int k) { for (int i = 0; i < LGNMAX; ++i) { if (k & 1) u = parent[i][u]; k >>= 1; } return u;}In this case  we go up to 7 from 9.At this stage  if the two vertices under consideration are the same  we are done (would have been the case if we started with 7 and 9  for example).