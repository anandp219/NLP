To do this easily  we precompute the factors in mask form. 1 2 3 4 5 6 7 8 910111213141516int factormask[59];for(int i=1;i<59;i++){ //Initialise with the empty subset factormask[i]=0; for(int j=0;j<16;j++) { if(i%p[j]==0) { //p[j] is a factor of i //We need to set the jth bit of mask to 1 factormask[i]|=(1<<j); } }}With this done  we can dive into the recurrence. Note that  in addition to the [math]\rm{DP}(i S)[/math] variable we defined in the solution section  we also need to find the best value of [math]b_i[/math] so that it can be output in the end.