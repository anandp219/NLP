Since there are only [math]16[/math] primes upto [math]58[/math]  we can do dynamic programming over the subsets of these primes.Define [math]\rm{DP}(i S)[/math] = minimum value of [math]\sum\limits_{j=1}^{i} |a_j-b_j|[/math] on choosing [math]b_j[/math]s such that their only prime factors are the prime numbers in the set [math]S[/math].Let us find a recurrence for [math]\rm{DP}(i S)[/math]. [math]b_i[/math] can be any number in the range [math]1 \cdots 58[/math] whose prime factors are all in [math]S[/math].