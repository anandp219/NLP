The last duel has to be won by i. The opponent of this duel has to be some muskeeter i'. Without loss of generality  suppose the i' is situated clockwise to i. Consider all the musketeers who lost to i' or lost to someone who lost to i' and so on. It is easy to see that all these musketeers have to be situated in a contiguous segment [k' k] for some value of k. Similarly  before i defeated i'  all the musketeers who lost to i or lost to someone who lost to i and so on  form another contiguous segment [j k'-1].Thus we obtain the recurrence:win(i j k) = 1IFFthere exist i'  j' : ji'j'<i and win(i' j j')=1 and win(i j'+1 k) = 1 and i defeats i'ORthere exist i'  k' : i<k'i'k and win(i' k' k)=1 and win(i j k'-1) = 1 and i defeats i'We are essentially looping over all possible last opponents and the segments they have conquered individually.