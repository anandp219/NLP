In this process  it was not just he who suffered  but the whole society. Finally  Krishna found no choice but to encourage Yudhisthira to break a couple of the rule. Again  it was not a complete breakdown  but tactically bending some of the rules. It was made in good intention and its outcome ended the war & ensured the society's survival. That makes it a dharma yuddham.Real life cannot be reduced to a mere collection of rules and morals is the key lesson of the epic. If the rules you made up stand in the way of protecting your subjects  be willing to bend/break.