He is definitely anti-CIA but it is easy to handle your enemies than your friends. I think someone is trying to shoot two birds with one arrow. They first feed information to CIA about the location of other terrorists. In exchange they get the top secret information from the CIA. According to Carrie  all the information provided by this asset was pure gold apart from this wedding instance. How can someone who knows this much about these terrorists didn't know that Haissam Haqqani was actually attending a wedding in Islamabad?