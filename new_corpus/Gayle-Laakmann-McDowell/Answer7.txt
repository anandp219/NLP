You haven't done this. This is the primary reason why the book's code is "longer": it's actually solving a different problem. If you strip this part out of the book's code  it's actually shorter and simpler than your code.If you make this change  there are two ways of doing it. You could check in advance (and save yourself the memory usage) or you can check after you've done the compression. You can debate which approach is better  and it depends on what assumptions you have. The book checks in advance  on the reasoning that if you really need to compress a string  then you potentially throwing long strings at it.