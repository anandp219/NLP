If not  we need to find the smallest number [math]x[/math] such that the [math]x[/math]th parent of [math]u[/math] is the same as the [math]x[/math]th parent of [math]v[/math].To do this  we can use the parent[][] array again. Find the largest value of [math]k[/math] such that the [math]2^k[/math]th parent of [math]u[/math] and [math]v[/math] are different  and update [math]u[/math] and [math]v[/math] to be those parents. Continue till [math]k=0[/math]  and it is easy to see that the vertices we end up with will be just below the LCA.Again  we are essentially building the distance from the vertices to the LCA bit-by bit.