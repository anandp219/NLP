 Steven has a very nice theory of Lockhart ratting out Sandy. Lockhart was definitely uneasy when Carrie told him that she knows that Lockhart knew Sandy was trading top secret information in exchange of the locations of terrorists. And his uneasiness makes sense because he authorized the demotion of Harris. So if it is proved that Harris was right and Sandy was indeed doing a "business" with the terrorists then Lockhart would be the first one to be hanged.But even though it has been established that Lockhart was doing something very wrong, I don't think he was responsible for leaking the photo of Sandy to the press. When Sandy reached his informant's home, the lock on the door was changed. Which means either the informant has turned against the CIA or the terrorists have identified the source of CIA's intel and asked the informant to lure Sandy in a trap. They smartly posted the photos online just after Sandy left the station. They also didn't show their face to Sandy and let the crowd take care of him.Another explanation, which is more likely, according to me, is that there is one terrorist who wants all his associates/partners dead. He is definitely anti-CIA but it is easy to handle your enemies than your friends. I think someone is trying to shoot two birds with one arrow. They first feed information to CIA about the location of other terrorists. In exchange they get the top secret information from the CIA. According to Carrie, all the information provided by this asset was pure gold apart from this wedding instance. How can someone who knows this much about these terrorists didn't know that Haissam Haqqani was actually attending a wedding in Islamabad? I think the informant knew this thing and they also knew that bombing this wedding would put CIA's back to the wall and will probably deflect them from this case (Lockhart was exactly following this approach when he decided to keep Carrie at Langley.)I am pretty sure that Lockhart never interacted with Sandy's informant. I think he didn't even know who he/she was. He just knew that Sandy was getting the information and since it was profiting him (Lockhart) he decided to keep his mouth shut about it. This way, if the story accidentally unveils in the future, he can simply say that he didn't know anything about this asset and there would be no proof to prove him wrong. So all the terrorists had to do was take care of Sandy and then no one would ever know about this "secret informant" of CIA. They got rid of Sandy and now this is gonna be very hard for Carrie and Quinn and Saul to get the whereabouts of this informant.