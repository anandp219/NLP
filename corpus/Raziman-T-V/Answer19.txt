 The (u,v) th element of the k th power of the adjacency matrix of an undirected graph gives the number of paths of length k between u and v.This is easily proved by induction. The case k=0 is straightforward. The k th power of the adjacency matrix A is just the identity matrix, and the number of 0 length paths between u and v is 1 iff u=v and 0 otherwise. Alternately, you can take k=1 as the base case and note that the number of 1 length paths between u and v is given by the (u,v) th element of A.Now, consider the (u,v) th element of [math]A^{k+1}[/math]. This is equal to the sum of [math]A(u,w) A^k(w,v)[/math]. Since [math]A(u,w)[/math] is non-zero and equal to one for precisely the neighbours of w, this expression is equal to the total number of paths between v and the neighbours of u with length k. But every such path corresponds to a u-v path of length k+1 since each such path consists of an edge from u to its neighbour, followed by any k length path from the neighbour to v. We have thus proved the inductive step.Finally, note that the matrix exponentiation has to be performed using exponentiation by squaring to reduce the number of matrix multiplications needed from O(k) to O(log k).