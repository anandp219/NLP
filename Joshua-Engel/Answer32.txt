 Joshua EngelI've seen different productions approach it differently. The text will support you in just about any decision you want to make.Ophelia could easily be presented as having little agency. Laertes tells her that she is not her own:The chariest maid is prodigal enough,If she unmask her beauty to the moon:Virtue itself 'scapes not calumnious strokesPolonius presents his orders in terms of how they reflect on him:I would not, in plain terms, from this time forth,Have you so slander any moment leisure,As to give words or talk with the Lord Hamlet.To which she answers simply: "I shall obey". He then uses her as bait in a trap. Hamlet roundly abuses her (the "nunnery" speech) while Polonius looks on, without doing anything. He doesn't even acknowledge her ordeal: "How now, Ophelia! You need not tell us what Lord Hamlet said; We heard it all." is all he has to say to her. Certainly in the medieval/renaissance context of the play, she has little power. She's unable to remove herself from the decidedly abominable actions of Hamlet at the Mousetrap.So it would be a very consistent intepretation to say that she takes the one true act of agency she can possibly take: to kill herself. This is the agency that Hamlet fails to take for himself, out of fear of the afterlife. This can be portrayed as the final act of a woman who has plenty of agency, but is merely constrained by the circumstances of her state as a woman. Lack of liberty need not deny your agency; it merely curtails your options. When her options are cut to zero, she takes the one action that anybody has left to them.Before that, she has been a woman of wit and purpose. She's been flirting with Hamlet. She tells Laertes to follow the same advice she's given him. So I could justify an interpretation of a bolder Ophelia who has fire in her eyes, and her lack of ability to apply it figures into what drives her mad.Gertrude is even more enigmatic. The circumstances of her marriage to Claudius are decidedly unclear. Did she know about the murder? Some productions start with the assumption that she did; some have even imagined her as being an active participant in the plot. Our perceptions of Claudius are colored by Hamlet as point-of-view character, but it's hard to say how true they are. Gertrude could be truly in love with Claudius, perhaps even before the murder (and perhaps as the cause). She could be simply trying to make the best choice, with her husband gone. Or she may simply be the passive recipient of the action, marrying Claudius by default.It's very common for Gertrude to be portrayed as a suicide. She's quite insistent about drinking from the cup. Did she know it was poisoned? Hamlet has told her that her husband is a poisoner, and honestly, who puts a pearl in a cup of wine? It's kind of clumsy. Much can be made in that scene of glances and tone of voice. She may be actively trying to make the only dignified exit she can make. Or she may be trying to save her son's life in the only way she knows.The latter choice is extremely common. In general, it's better to make an active choice than a passive one. And another good rule of thumb: love is always the strongest choice. She can love her first husband, or Claudius, or Hamlet... or all three. So I would practically always play these roles with as much agency as I could. The text would justify a different choice, but it's likely to be a less interesting one.